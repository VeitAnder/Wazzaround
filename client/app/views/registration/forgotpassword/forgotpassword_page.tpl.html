<div class="page"
     ng-show="!isAuthenticated">
  <div class="authpage">
    <div class="innerwrap">

      <form name="valForm"
            novalidate
            class="registrationform"
            ui-keyup="{27: 'cancel()'}"
            ng-hide="status.resetpassword === true"
          >
        <div ng-hide="status.passwordrequestsuccess === true">
          <h1>Passwort vergessen?</h1>

          <label>E-Mail</label>

          <p>
            <input ng-pattern="/^[A-Za-z0-9._%+-]+@[A-Za-z0-9.-]+\.[A-Za-z]{2,4}$/"
                   name="email"
                   id="email"
                   placeholder="E-Mail Adresse"
                   ng-model="user.email"
                   required
                >
            <span ng-show="showError('valForm', 'email', 'pattern')"
                  class="alert alert-error">Bitte geben Sie eine gültige E-Mail Adresse ein.
            </span>
            <span ng-show="showError('valForm', 'email', 'required')"
                  class="alert">Bitte füllen Sie dieses Feld aus.
            </span>
          </p>
          <div class="buttonbar">
            <button ng-click="requestPasswordReset()"
                    ng-disabled="!canSave()">Link zum Passwort-Zurücksetzen anfordern
            </button>
            <a class="cancel"
               ng-click="cancel()">zurück zum Login
            </a>
          </div>
        </div>

        <div ng-show="status.passwordrequestsuccess === true">
          <p class="alert alert-success">Das neue Passwort wurde an {{user.email}} versendet.</p>

          <div class="buttonbar backto">
            <a ng-click="gotoLogin()">zurück zum Login</a>
          </div>
        </div>

        <div ng-show="status.passwordrequestsuccess === false">
          <p class="alert alert-error">Es ist ein Fehler aufgetreten.
                                       Das Email zum Zurücksetzen des Passworts konnte nicht verschickt werden.
                                       Bitte wenden Sie sich an das Planfred Support Team.</p>
        </div>
      </form>

      <form name="newPasswordForm"
            ng-show="status.resetpassword && !status.setnewpasswordsuccess">
        <p>Geben Sie Ihr neues Passwort hier ein</p>

        <p>

          <label for="password">Passwort</label>
          <input name="password"
                 id="password"
                 type="password"
                 ng-model="settingnew.password"
                 required
                 class="input-block-level">
          <span ng-show="showError('newPasswordForm', 'password', 'required')"
                class="alert">Bitte füllen Sie dieses Feld aus.
          </span>
        </p>

        <p>
          <label for="passwordrepeat">Passwort wiederholen</label>
          <input name="passwordrepeat"
                 id="passwordrepeat"
                 type="password"
                 ng-model="settingnew.passwordrepeat"
                 required
                 class="input-block-level"
                 validate-equals="settingnew.password"
              >

          <span ng-show="showError('newPasswordForm', 'passwordrepeat', 'equal')"
                class="alert alert-error">Die Passwörter stimmen nicht überein.
          </span>
          <span ng-show="showError('newPasswordForm', 'passwordrepeat', 'required')"
                class="alert">Bitte füllen Sie dieses Feld aus.
          </span>

        </p>

        <button class="btn"
                type="submit"
                ng-click="setNewPassword()">Neues Passwort speichern
        </button>
      </form>

      <div ng-show="status.setnewpasswordsuccess === true">
        <p class="alert alert-success">Das neue Passwort wurde versendet.</p>

        <div class="buttonbar backto">
          <a ng-click="gotoLogin()">zurück zum Login</a>
        </div>
      </div>

      <div ng-show="status.setnewpasswordsuccess === false">
        <p class="alert alert-error">Es ist ein Fehler aufgetreten.
                                     Das neue Passwort konnte nicht gespeichert werden.
                                     Bitte wenden Sie sich an das Planfred Support Team.</p>
      </div>
    </div>

  </div>

</div>
