<div class="container">
  <div class="row">
    <div class="col-sm-12"
         ng-class="{deletemode: state.actionlinkisopen}"
        >
      <h2>{{'Activities' | translate}}</h2>

      <!-- ## PUBLISH STATES AREA ################################################################################-->

      <activitystatearea>

        <p class="alert alert-large alert-block alert-success"
           ng-if="activity.published">
          {{'This activity is published' | translate}}
        </p>

        <p class="alert alert-large alert-block alert-error"
           ng-if="!activity.published">
          {{'This activity is not published yet' | translate}}
        </p>

        <div ng-controller="PublishstateCtrl as publishstatectrl">

          <span ng-switch="activity.published">

            <!--ALL UNPUBLISHED ACTIVITIES-->

            <!-- DENIED = unpublished + denied -->
            <span ng-switch-when="false"
                  class="activitystatedescription"
                >
              <span
                  ng-if="activity.denied"
                  >
                <p><b>{{'Denied activity' | translate}}</b></p>

                <button
                    class="btn btn-mini"
                    data-ng-click="publishstatectrl.publish($event, activity)"
                    >
                  {{'publish' | translate}}
                </button>
              </span>

              <span ng-switch="activity.unreviewedChanges > 0">

                <!-- NEW = unpublished + unreviewedChanges + not denied -->
                <span ng-switch-when="true"
                      ng-if="!activity.denied"
                    >
                  <p><b>{{'New activity – Please review' | translate}}</b></p>
                  <button
                      class="btn btn-mini"
                      data-ng-click="publishstatectrl.verify($event, activity)"
                      >
                    {{'approve' | translate}}
                  </button>
                  <button
                      class="btn btn-mini btn-alert"
                      data-ng-click="publishstatectrl.deny($event, activity)"
                      >
                    {{'deny' | translate}}
                  </button>
                </span>

              </span>
            </span>

            <!--ALL PUBLISHED ACTIVITIES-->

            <span
                ng-switch-when="true"
                class="activitystatedescription"
                >

              <span ng-switch="activity.unreviewedChanges > 0">
                <span ng-switch-when="true">

                  <p><b>{{'Changed activity – Please review' | translate}}</b></p>
                  <button
                      class="btn btn-mini"
                      data-ng-click="publishstatectrl.verify($event, activity)"
                      >
                    {{'approve' | translate}}
                  </button>
                  <button
                      class="btn btn-mini btn-alert"
                      data-ng-click="publishstatectrl.deny($event, activity)"
                      >
                    {{'deny' | translate}}
                  </button>

                </span>
                <span ng-switch-when="false">
                  <button
                      class="btn btn-mini btn-alert"
                      data-ng-click="publishstatectrl.deny($event, activity)"
                      >
                    {{'deny' | translate}}
                  </button>

                </span>

              </span>

            </span>
            <span ng-switch-default>-</span>
          </span>

          <!--          <span ng-if="activity.unreviewedChanges > 0">
                      + {{activity.unreviewedChanges}} changes
                    </span>
                    <span ng-switch="activity.published">
                      <span ng-switch-when="false"
                            class="btn btn-mini"
                            data-ng-click="publishstatectrl.publish($event, activity)"
                          >
                        {{'publish' | translate}}
                      </span>
                      <span ng-switch-when="false"
                            ng-if="!activity.denied"
                            class="btn btn-mini"
                            data-ng-click="publishstatectrl.deny($event, activity)"
                          >
                        deny
                      </span>
                      <span ng-switch-when="true">
                        <span ng-switch="activity.unreviewedChanges > 0">
                          <span ng-switch-when="true">

                            <span class="btn btn-mini"
                                  data-ng-click="publishstatectrl.verify($event, activity)"
                                >
                              verify
                            </span>

                            <span class="btn btn-mini"
                                  data-ng-click="publishstatectrl.remove($event, activity)"
                                >
                              remove
                            </span>

                          </span>
                          <span ng-switch-when="false"
                                class="btn btn-mini"
                                data-ng-click="publishstatectrl.toggle($event, activity)"
                              >
                            {{'unpublish' | translate}}
                          </span>
                        </span>

                      </span>
                      <span ng-switch-default>-</span>
                    </span>-->
        </div>
      </activitystatearea>

      <div
          class="activity-detail detail-category-{{activity.category.main}}"
          >
        <div class="buttonbar buttonbar-5050 buttonbar-top">
          <div class="cell">
            <action-confirmation-link
                action="delete()"
                label="{{'delete' | translate}}"
                confirmation-label="{{'yes, delete' | translate}}"
                confirmation-description="{{'Do you want to delete the entire activity' | translate}}"
                cancel-label="{{'no' | translate}}"
                is-open="state.actionlinkisopen"
                >
            </action-confirmation-link>
          </div>
          <div class="cell">
            <a class="btn btn-small"
               href="#/admin/myactivities/{{activity._id}}/edit/">{{'edit' | translate}}
            </a>
          </div>
        </div>

        <!-- ## TITLE & DESCRIPTION ################################################################################ -->

        <h3 class="title">
          {{activity.name | languageselect}}
        </h3>

        <h5 class="category no-margin-top">
          {{activity.category.main | translate}}
          <span class="category-sub"
                ng-repeat="subcat in activity.category.subs">
            / {{subcat.key | translate}}
          </span>
        </h5>

        <h6 class="no-margin-top">
          {{'Offered by' | translate}}
          <activityowner activity="activity"></activityowner>
        </h6>

        <h5 class="shortdescription">
          {{activity.shortdescription[getAvailableTranslationLanguageKey(activity.shortdescription)]}}
        </h5>

        <div class="description"
             ng-bind-html="activity.description[getAvailableTranslationLanguageKey(activity.description)] | nohtml | linebreak"
            >
        </div>

        <div class="location">
          <div class="input-label">{{'Location' | translate}}:</div>

          <google-map
              center='map.center'
              zoom='map.zoom'
              draggable='true'
              options='map.options'
              >
            <marker
                coords='map.markercoords'
                icon='getMarkerIcon()'
                idKey='1'
                >
              <marker-label content="activity.name[getAvailableTranslationLanguageKey(activity.name)]"
                            anchor="22 0"
                            class="marker-labels marker-label-category-{{activity.category.main}}"
                  />
            </marker>

          </google-map>

        </div>

        <div class="img-block img-block-right"
             ng-show="activity.images.length > 0"
            >
          <cloudinaryimage ng-repeat="image in activity.images"
                           data-publicid="{{image.public_id}}"
                           data-format="{{image.format}}"
                           data-width="375"
                           data-height="225"
              >
          </cloudinaryimage>
        </div>

        <div class="availability">
          <div class="input-label">{{'Availability' | translate}}</div>

          <!--          <div class="availability-filter">
                      <div class="form-group-inline form-group-inline-5050">
                        <div class="form-group date-from">
                          <label>{{'from' | translate}}</label>
                          <input type="text"
                                 class="form-control"
                                 ng-model="frontendmap.map.searchStartDate"
                                 data-min-date="{{search.minDate}}"
                                 placeholder="{{'From' | translate}}"
                                 bs-datepicker
                                 autoclose="false"
                              >
                        </div>
                        <div class="form-group date-until">
                          <label>{{'until' | translate}}</label>
                          <input type="text"
                                 class="form-control"
                                 ng-model="frontendmap.map.searchEndDate"
                                 data-min-date="{{frontendmap.map.searchStartDate}}"
                                 data-max-date="{{search.maxDate}}"
                                 placeholder="{{'Until' | translate}}"
                                 bs-datepicker
                                 autoclose="false"
                              >
                        </div>
                      </div>

                      <div class="bookableitem-tags">
                        <a class="bookableitem-tag"
                           ng-click="selected1 = !selected1"
                           ng-class="{selected: selected1}"
                            >
                          <span class="checkbox-tag"></span>
                          Show all
                          <span class="numberofitems">1</span>
                        </a>

                        <a class="bookableitem-tag"
                           ng-click="selected2 = !selected2"
                           ng-class="{selected: selected2}"
                            >
                          <span class="checkbox-tag"></span>
                          Bookable Item A
                          <span class="numberofitems">1</span>
                        </a>
                      </div>
                    </div>

                    <div class="divider">
                      <span>
                        <strong>Today</strong>
                        (Tue, May 13 2014)
                      </span>
                    </div>-->

          <bookableitemlist
              activity="activity"
              >
          </bookableitemlist>

        </div>
        <div class="buttonbar buttonbar-5050 margin-top">
          <div class="cell">
            <action-confirmation-link
                action="delete()"
                label="{{'delete' | translate}}"
                confirmation-label="{{'yes, delete' | translate}}"
                confirmation-description="{{'Do you want to delete the entire activity' | translate}}"
                cancel-label="{{'no' | translate}}"
                is-open="state.actionlinkisopen"
                >
            </action-confirmation-link>
          </div>
          <div class="cell">
            <a class="btn btn-small"
               href="#/admin/myactivities/{{activity._id}}/edit/">{{'edit' | translate}}
            </a>
          </div>
        </div>
        <p
            ng-hide="state.actionlinkisopen"
            >
          <a class="text-link"
             href="#/admin/myactivities/">{{'back to my activities' | translate}}
          </a>
        </p>

      </div>

    </div>
  </div>
</div>